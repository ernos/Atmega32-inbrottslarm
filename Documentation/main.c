#ifdef __GNUC__ // to avoid error messages in visual studio editor
#include <avr/io.h>
#else
#include <avr/iom8.h>
#endif
#include <avr/interrupt.h>
#define F_CPU 8000000UL
#include <util/delay.h>
#include "usart.h"
#include "timer.h"
#include "display.h"
#include "F-Bus.h"
#include "ADC.h"
extern unsigned char RecipientNo[8];
int test = 0;
/*
	unsigned char SMSC[] = {0x07, 0x91, 0x64, 0x07, 0x97, 0x09, 0x00, 0xF1, 0x00, 0x00, 0x00, 0x00};
						 //{0x08, 0x91, 0x69, 0x74, 0x07, 0x11, 0x44, 0x11, 0xF0, 0x00, 0x00, 0x00};																		//F=padding
	unsigned char RecipientNo[] =	{0x07 ,0x91 ,0x64 , 0x37 , 0x56 , 0x86 , 0x88 ,0xF1, 0x00, 0x00, 0x00, 0x00};

Byte: 00 01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35
Data: 1E 00 0C 02 00 59 00 01 00 01 02 00 07 91 16 14 91 09 10 F0 00 00 00 00 15 00 00 00 33 0A 81 40 30 87 00 47
SMS                              message centre --                                  Phone number -

Byte: 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71
Data: 00 00 00 00 00 A7 00 00 00 00 00 00 C8 34 28 C8 66 BB 40 54 74 7A 0E 6A 97 E7 F3 F0 B9 0C BA 87 E7 A0 79 D9
Start of Message - Hi All. This message was sent through F-Bus. Cool!!

Byte: 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97
Data: 4D 07 D1 D1 F2 77 FD 8C 06 19 5B C2 FA DC 05 1A BE DF EC 50 08 01 43 00 7A 52

*/
/*
char fbustestframe[] =	{	0x1E, 0x00, 0x0C, 0x02, 0x00, 0x59, 0x00, 0x01, 0x00, 0x01,
							0x02, 0x00, 0x07, 0x91, 0x64, 0x07, 0x97, 0x09, 0x00, 0xF1,
							0x00, 0x00, 0x00, 0x00, 0x15, 0x00, 0x00, 0x00, 0x33, 0x07,
							0x91, 0x64, 0x37, 0x56, 0x86, 0x88, 0xF1, 0x00, 0x00, 0x00,
							0x00, 0xA7, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC8, 0x34, 
							0x28, 0xC8, 0x66, 0xBB, 0x40, 0x54, 0x74, 0x7A, 0x0E, 0x6A,
							0x97, 0xE7, 0xF3, 0xF0, 0xB9, 0x0C, 0xBA, 0x87, 0xE7, 0xA0, 
							0x79, 0xD9, 0x4D, 0x07, 0xD1, 0xD1, 0xF2, 0x77, 0xFD, 0x8C, 
							0x06, 0x19, 0x5B, 0xC2, 0xFA, 0xDC, 0x05, 0x1A, 0xBE, 0xDF, 
							0xEC, 0x50, 0x08, 0x01, 0x43, 0x00, 0x7A, 0x52};*/

int main( void)
{
	unsigned char cnt=0;
	_init_timer1();
	InitADC();
	usart_init(8) ;//8:115.2 kbps,103:9600 kbps
	_delay_ms (1000);
	InitDisplay();
	initPhone();
	ReadTemperature();
	SendSMS("Start of Message",RecipientNo);
	
	/*for(int i = 0; i < sizeof(fbustestframe); i++)
	{
		puts(fbustestframe[i]);
	}*/
	while( 1)
	{
		if(++cnt==50)
		{
			cnt =0;
			ReadTemperature();
		}
		RefreshDisplay ();
	}
	return 0;
}


